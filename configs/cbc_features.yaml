# CBC (Complete Blood Count) Features Configuration
# Maps MIMIC-IV itemids to standardized feature names

cbc_features:
  # Red Blood Cell Parameters
  hemoglobin:
    itemids: [51222, 50811]
    unit: "g/dL"
    description: "Hemoglobin concentration"
    normal_range: [12.0, 17.0]
    reference_range:
      low: 12.0
      high: 17.5

  hematocrit:
    itemids: [51221, 50810]
    unit: "%"
    description: "Hematocrit percentage"
    normal_range: [36.0, 48.0]
    reference_range:
      low: 36.0
      high: 50.0

  rbc:
    itemids: [51279]
    unit: "M/uL"
    description: "Red blood cell count"
    normal_range: [4.0, 5.5]
    reference_range:
      low: 4.0
      high: 5.5

  mcv:
    itemids: [51250]
    unit: "fL"
    description: "Mean corpuscular volume"
    normal_range: [80, 100]
    reference_range:
      low: 80
      high: 100

  mch:
    itemids: [51248]
    unit: "pg"
    description: "Mean corpuscular hemoglobin"
    normal_range: [27, 33]
    reference_range:
      low: 27
      high: 33

  mchc:
    itemids: [51249]
    unit: "g/dL"
    description: "Mean corpuscular hemoglobin concentration"
    normal_range: [32, 36]
    reference_range:
      low: 32
      high: 36

  rdw:
    itemids: [51277]
    unit: "%"
    description: "Red cell distribution width"
    normal_range: [11.5, 14.5]
    reference_range:
      low: 11.5
      high: 14.5

  # White Blood Cell Parameters
  wbc:
    itemids: [51301, 51300]
    unit: "K/uL"
    description: "White blood cell count"
    normal_range: [4.5, 11.0]
    reference_range:
      low: 4.5
      high: 11.0

  neutrophils:
    itemids: [51256]
    unit: "%"
    description: "Neutrophil percentage"
    normal_range: [40, 70]
    reference_range:
      low: 40
      high: 70

  lymphocytes:
    itemids: [51244, 51245]
    unit: "%"
    description: "Lymphocyte percentage"
    normal_range: [20, 40]
    reference_range:
      low: 20
      high: 40

  monocytes:
    itemids: [51254]
    unit: "%"
    description: "Monocyte percentage"
    normal_range: [2, 8]
    reference_range:
      low: 2
      high: 8

  eosinophils:
    itemids: [51200]
    unit: "%"
    description: "Eosinophil percentage"
    normal_range: [1, 4]
    reference_range:
      low: 1
      high: 4

  basophils:
    itemids: [51146]
    unit: "%"
    description: "Basophil percentage"
    normal_range: [0, 1]
    reference_range:
      low: 0
      high: 1

  # Platelet Parameters
  platelets:
    itemids: [51265]
    unit: "K/uL"
    description: "Platelet count"
    normal_range: [150, 400]
    reference_range:
      low: 150
      high: 400

  mpv:
    itemids: [51264]
    unit: "fL"
    description: "Mean platelet volume"
    normal_range: [7.5, 11.5]
    reference_range:
      low: 7.5
      high: 11.5

# Feature groups for different analysis types
feature_groups:
  rbc_indices:
    - hemoglobin
    - hematocrit
    - rbc
    - mcv
    - mch
    - mchc
    - rdw

  wbc_differential:
    - wbc
    - neutrophils
    - lymphocytes
    - monocytes
    - eosinophils
    - basophils

  platelet_indices:
    - platelets
    - mpv

  core_cbc:
    - hemoglobin
    - hematocrit
    - wbc
    - platelets

# Literature-based thresholds for biomarker generation
# These are clinically-relevant thresholds for different diseases
literature_thresholds:
  rheumatoid_arthritis:
    # Anemia is common in RA
    hemoglobin:
      low: 12.0  # Anemia threshold (g/dL)
      high: 17.5
    # Inflammation markers
    wbc:
      low: 4.5
      high: 11.0  # Elevated in active disease (K/uL)
    platelets:
      low: 150
      high: 400  # Thrombocytosis in inflammation (K/uL)
    hematocrit:
      low: 36.0  # Anemia (%)
      high: 50.0
    # Additional markers
    neutrophils:
      low: 40
      high: 70  # Can be elevated (%)
    lymphocytes:
      low: 20  # Can be decreased (%)
      high: 40

  diabetes_type1:
    # Immune-related changes
    wbc:
      low: 4.5
      high: 11.0
    neutrophils:
      low: 40
      high: 70
    lymphocytes:
      low: 20
      high: 40
    platelets:
      low: 150
      high: 400

  diabetes_type2:
    # Metabolic and inflammatory markers
    hemoglobin:
      low: 12.0
      high: 17.5
    wbc:
      low: 4.5
      high: 11.0  # Elevated in metabolic syndrome
    platelets:
      low: 150
      high: 400  # Increased platelet reactivity
    hematocrit:
      low: 36.0
      high: 50.0

  crohns_disease:
    # Anemia from chronic inflammation and bleeding
    hemoglobin:
      low: 10.0  # Lower threshold for IBD anemia (g/dL)
      high: 17.5
    hematocrit:
      low: 32.0  # Lower threshold for IBD (%)
      high: 50.0
    # Inflammation and immune response
    wbc:
      low: 4.5
      high: 11.0  # Elevated in active disease
    platelets:
      low: 150
      high: 450  # Reactive thrombocytosis (K/uL)
    # Iron deficiency markers
    mcv:
      low: 75  # Microcytosis from iron deficiency (fL)
      high: 100
    rdw:
      low: 11.5
      high: 16.0  # Elevated with anisocytosis (%)

  psoriasis:
    # Systemic inflammation markers
    wbc:
      low: 4.5
      high: 11.0
    neutrophils:
      low: 40
      high: 70
    platelets:
      low: 150
      high: 400
    lymphocytes:
      low: 20
      high: 40

# SHAP-based model configurations
# These settings control the models used for SHAP feature selection
shap_config:
  # Default model configuration for SHAP-based generators
  default_model:
    model_type: "RandomForest"  # Options: RandomForest, XGBoost, LogisticRegression
    n_estimators: 100
    max_depth: 10
    min_samples_split: 5
    random_state: 42

  # Alternative configurations for different use cases
  models:
    random_forest:
      model_type: "RandomForest"
      n_estimators: 100
      max_depth: 10
      min_samples_split: 5
      random_state: 42

    xgboost:
      model_type: "XGBoost"
      n_estimators: 100
      max_depth: 6
      learning_rate: 0.1
      random_state: 42

    logistic_regression:
      model_type: "LogisticRegression"
      max_iter: 1000
      random_state: 42

  # SHAP explainer preferences
  explainer:
    type: "auto"  # Options: auto, tree, linear, kernel
    background_samples: 100  # For KernelExplainer

  # Cross-validation settings for threshold optimization
  cross_validation:
    use_cv: true
    cv_folds: 5
